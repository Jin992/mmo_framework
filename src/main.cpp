#include "Server.hpp"
#include <boost/asio/io_context.hpp>
#include "json.hpp"

using json = nlohmann::json;

void display_header()
{
    std::string header( 
    "███╗   ██╗███████╗ ██████╗ ███╗   ██╗        ███╗   ███╗███╗   ███╗ ██████╗\n"   
    "████╗  ██║██╔════╝██╔═══██╗████╗  ██║        ████╗ ████║████╗ ████║██╔═══██╗\n"  
    "██╔██╗ ██║█████╗  ██║   ██║██╔██╗ ██║        ██╔████╔██║██╔████╔██║██║   ██║\n"  
    "██║╚██╗██║██╔══╝  ██║   ██║██║╚██╗██║        ██║╚██╔╝██║██║╚██╔╝██║██║   ██║\n"  
    "██║ ╚████║███████╗╚██████╔╝██║ ╚████║        ██║ ╚═╝ ██║██║ ╚═╝ ██║╚██████╔╝\n"  
    "╚═╝  ╚═══╝╚══════╝ ╚═════╝ ╚═╝  ╚═══╝        ╚═╝     ╚═╝╚═╝     ╚═╝ ╚═════╝\n"   
    "\n"                                                                          
    "███████╗██████╗  █████╗ ███╗   ███╗███████╗██╗    ██╗ ██████╗ ██████╗ ██╗  ██╗\n"
    "██╔════╝██╔══██╗██╔══██╗████╗ ████║██╔════╝██║    ██║██╔═══██╗██╔══██╗██║ ██╔╝\n"
    "█████╗  ██████╔╝███████║██╔████╔██║█████╗  ██║ █╗ ██║██║   ██║██████╔╝█████╔╝\n" 
    "██╔══╝  ██╔══██╗██╔══██║██║╚██╔╝██║██╔══╝  ██║███╗██║██║   ██║██╔══██╗██╔═██╗\n"
    "██║     ██║  ██║██║  ██║██║ ╚═╝ ██║███████╗╚███╔███╔╝╚██████╔╝██║  ██║██║  ██╗\n"
    "╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝ ╚══╝╚══╝  ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝\n"
    );
    std::cout << header << std::endl;
}

int main() {
    display_header();

    TcpServer server(8555);

    auto callback = [](char* data, std::size_t len) {
        std::string result(data, data + len);
        json jsonData= json::parse(result);
        std::cout << jsonData.dump() << std::endl;

        //std::cout << "Msg Len: " << len << std::endl;

    };
    server.run(callback);
    return 0;
}